<html>
  <head>
  	<title>Processamento de Vídeo - Relatório</title>
	<style>
		table {
			font-family: arial, sans-serif;
			border-collapse: collapse;
			width: 100%;
		}

		td, th {
			border: 1px solid #dddddd;
			text-align: left;
			padding: 8px;
		}

		tr:nth-child(even) {
			background-color: #dddddd;
		}
</style>
  </head>
    
	<body>
		<h1>UNIVERSIDADE FEDERAL DO ABC</h1>
		<h2>Trabalho de Vídeo T1 - Identificação de Cartas de Magic</h2>
		<p>Anthony Hlebania</p>
		<p>Fernando Astolfo Dos Santos</p>
		<p>Fernando Hiroaki Suzuki - RA: 11202130281</p>
		<p>Leonardo Di Credico     - RA: 11202130507</p>

		<h2>1. Introdução</h2>
		
		<p>Magic: The Gathering (MTG) é um jogo de cartas colecionáveis lançado em 1993 pela Wizards of the Coast. 
		O objetivo do jogo é derrotar o oponente reduzindo sua vida a zero ou por meio de condições de 
		vitória específicas. Nele, cada jogador constrói seu próprio baralho antes do jogo, escolhendo 
		entre milhares de cartas disponíveis, que representam criaturas, feitiços, terrenos e outros 
		tipos de cartas existentes no jogo.</p>

		<p>Além da forma física, o Magic: The Gathering também possui uma forma de jogo online chamada 
			"Magic Arena" e uma forma online de jogar com as cartas físicas através de um site da própria 
			Wizards of the Coast chamado de "Spelltable". Nessa versão, os jogadores usam seus decks físicos 
			para jogar contra oponentes de todo o mundo através da internet. O "Spelltable" oferece uma 
			experiência de jogo que visa se aproximar à versão física, fazendo com que os jogadores tenham 
			diversos formatos para serem jogados.</p>

		<p>Para a identificação das cartas no "Spelltable", os jogadores utilizam um sistema de stream que envia 
			imagens de seus tabuleiros em tempo real para o site onde os outros jogadores podem ver todas as 
			cartas em suas respectivas mesas tornando possível a simulação do jogo físico, fornecendo uma 
			prova visual das ações tomadas durante a partida. Essa medida é adotada para garantir a integridade 
			do jogo e evitar trapaças, além de aumentar a imersão no jogo.</p>

		<p>Embora o uso de câmeras para identificar as cartas no "Spelltable" seja uma solução prática, como em 
			qualquer programa, pode haver problemas ocasionais e bugs. O bug mais preocupante é o que impede 
			o sistema de ler quais cartas estão na mesa, pois geralmente a qualidade da imagem nem sempreé das 
			melhores então o recurso de scanear a carta facilita a vida dos jogadores. Isso pode ser frustrante 
			para os jogadores, pois pode resultar em jogadas erradas por falta de conhecimento das cartas em 
			campo.</p>

		<p>Diante disso, o projeto do Grupo Crakehall Boars consiste em desenvolver um programa que consiga 
			replicar a identificação de cartas que o já consolidado site "Spelltable" realiza nas partidas de 
			Magic: The Gathering.</p>

		<p>Com relação aos objetivos, nosso projeto tem como um deles, a criação desse programa que consiga
		realizar a identificação das cartas de Magic utilizadas nas partidas online. Mas além disso, o objetivo
		principal é utilizar os conceitos vistos na disciplina de Processamento de Vídeo para o desenvolvimento 
		de um projeto que possa atender demandas reais do nosso cotidiano.</p>

		<h2>2. Materiais e Métodos</h2>

		<h3>2.1. Cenário de Aplicação (CA)</h3>
			<a href=../context/application_context.html>CA</a> <br>
			
		<h3>2.2. Modelagem Funcional do Sistema de Processamento Visual (MFS)</h3>
			<a href=../plan/plan.html>MFS</a> <br>

		<h3>2.3. Cronograma efetivo do desenvolvimento do SPV</h3>
			 <table>
				  <tr>
				    <th>Data</th>
				    <th>Funcionalidade</th>
				    <th></th>
				  </tr>
				  <tr>
				    <td>14/07</td>
				    <td>Inicio do Desenvolvimento</td>
				  </tr>
				  <tr>
				    <td>15/07</td>
				    <td>Primeira versão da Interface Gráfica</td>
				  </tr>
				  <tr>
				    <td>21/07</td>
				    <td>Detecção de Cliques e criação do Algoritimo de Separação de Cartas</td>
				  </tr>
				  <tr>
				    <td>23/07</td>
				    <td>Integração do Algoritimo de Separação de Cartas</td>
				  </tr>
				  <tr>
				    <td>24/07</td>
				    <td>Integração do Algoritimo de Identificação de cartas</td>
				  </tr>
				  <tr>
				    <td>09/08</td>
				    <td>Criação dos testes automatizados</td>
				  </tr>
				  <tr>
				    <td>11/08</td>
				    <td>Correção de erros no redimensionamento das imagens</td>
				  </tr>
				  <tr>
				    <td>16/08</td>
				    <td>Coleta de imagens para segunda bateria de testes automatizados</td>
				  </tr>
				  <tr>
				    <td>17/08</td>
				    <td>Comparação de Métodos de identificação de cartas</td>
				  </tr>
				  <tr>
				    <td>17/08</td>
				    <td>Identificação de cartas por meio de SIFT</td>
				  </tr>
				  <tr>
				    <td>18/08</td>
				    <td>Teste de Campo</td>
				  </tr>
			<table></table>

		<h3>2.4. Aplicação do SPV</h3>
		<a href=../SPV/SPV.html>SPV</a> <br>

		<h3>2.5. Análise técnica</h3>

		<p>
			Para avaliar de forma objetiva, foram criados 2 conjuntos de testes automáticos, através deles
			testamos múltiplas formas de comparação das imagens da câmera com as do banco de dados, abaixo temos os resultados.

			<h4>Testes de identificação</h4>
			<p>O objetivo é validar apenas o sistema de identificação de imagens em situação ideal, com imagens bem cortadas e em boa qualidade.</p>
			 <table>
				  <tr>
				    <th>Métodod e Comparação</th>
				    <th>Taxa de Acerto (%)</th>
				    <th>Tempo para identificar 22 amostras (s)</th>
				  </tr>
				  <tr>
				    <td>WHash</td>
				    <td>68.15</td>
					<td>2.123</td>
				  </tr>
				  <tr>
				    <td>PHashSimple</td>
				    <td>54.55</td>
					<td>0.595</td>
				  </tr>
				  <tr style="background-color: #33ff00;">
				    <td>PHash</td>
				    <td>100</td>
					<td>0.786</td>
				  </tr>
				  <tr>
				    <td>DHashVertical</td>
				    <td>72.73</td>
					<td>0.522</td>
				  </tr>
				  <tr style="background-color: #33ff00;">
				    <td>DHash</td>
				    <td>100</td>
					<td>0.526</td>
				  </tr>
				  <tr>
				    <td>CropResistantHash</td>
				    <td>90.91</td>
					<td>10.278</td>
				  </tr>
				  <tr>
				    <td>AverageHash</td>
				    <td>90.91</td>
					<td>0.837</td>
				  </tr>
				  <tr>
				    <td>ColorHash</td>
				    <td>31.82</td>
					<td>0.827</td>
				  </tr>
				  <tr>
				    <td>Sift</td>
				    <td>81.82</td>
					<td>2.469</td>
				  </tr>
			</table>


		</p>

			<h4>Testes completos</h4>
			<p>O objetivo é testar o sistema completa em uma situação mais próxima da real, recebendo uma imagem com várias cartas e a posição da carta alvo. Testa tanto a identificação quanto a separação.</p>
			 <table>
				  <tr>
				    <th>Métodod e Comparação</th>
				    <th>Taxa de Acerto (%)</th>
				    <th>Tempo para identificar 47 amostras (s)</th>
				  </tr>
				  <tr>
				    <td>WHash</td>
				    <td>32.19</td>
					<td>2.210</td>
				  </tr>
				  <tr>
				    <td>PHashSimple</td>
				    <td>19.93</td>
					<td>1.764</td>
				  </tr>
				  <tr>
				    <td>PHash</td>
				    <td>38.23</td>
					<td>1.818</td>
				  </tr>
				  <tr>
				    <td>DHashVertical</td>
				    <td>37.37</td>
					<td>1.645</td>
				  </tr>
				  <tr>
				    <td>DHash</td>
				    <td>47.09</td>
					<td>1.664</td>
				  </tr>
				  <tr>
				    <td>CropResistantHash</td>
				    <td>31.37</td>
					<td>16.912</td>
				  </tr>
				  <tr>
				    <td>AverageHash</td>
				    <td>27.47</td>
					<td>1.653</td>
				  </tr>
				  <tr>
				    <td>ColorHash</td>
				    <td>6.72</td>
					<td>1.955</td>
				  </tr>
				  <tr  style="background-color: #33ff00;">
				    <td>Sift</td>
				    <td>82.02</td>
					<td>21.258</td>
				  </tr>
			</table>
			
			<p>
				Durante os testes de identificação, o método PHash e DHash tiveram resultados excelentes, com 100% de acerto.
				Entretanto, durante os testes completos, obtiveram uma taxa de menos de 50%, nestes testes o maior resultado
				foi obtido, disparadamente, pelo método Sift, com 82.02% de taxa de acerto. </p>
			<p>
				Como o teste completo reflete mais uma situação real de uso, o método Sift foi escolhido para ser usado na 
				aplicação. Apesar dele ser muito mais lento em relação aos outros, isso não causa nenhum impacto durante o 
				uso, esse tempo fica concetrado no calculo do sift em todos os os arquivos das imagens de referência, o
				que acontece apenas na inicialização do programa. Durante o uso, a identificação fica em torno de 0.3s.

			</p>
			<p>
				Mesmo com uma taxa de identificação de 82.02%, em situação reais o problema acaba tendo uma performance
				aparentemente menor, pois a <b>iluminação</b>, <b>rotação</b> e <b>reflexo</b> das cartas atrapalha muito a identificação.
			</p>

		</p>
		<h3>2.6. Lista dos arquivos</h3>
			 <table>
				  <tr>
				    <th>Diretório</th>
				    <th>Arquivo</th>
				    <th>Descrição</th>
				  </tr>
				  <tr>
				    <td>src</td>
				    <td>main.py</td>
					<td>Loop principal da aplicação</td>
				  </tr>
				  <tr>
				    <td>src</td>
				    <td>interface_manager.py</td>
					<td>Renderização da interface gráfica do programa, processamento de inputs do usuário e integração dos outros arquivos</td>
				  </tr>
				  <tr>
				    <td>src</td>
				    <td>card_separator.py</td>
					<td>Recorte da carta selecionada.</td>
				  </tr>
				  <tr>
				    <td>src</td>
				    <td>card_identificator.py</td>
					<td>Comparação da carta recortada com as imagens de referência.</td>
				  </tr>
				  <tr>
				    <td>.</td>
				    <td>run.sh</td>
					<td>Comando para execução do programa</td>
				  </tr>
				  <tr>
				    <td>.</td>
				    <td>setup.sh</td>
					<td>Instalação de dependências do programa</td>
				  </tr>
				  <tr>
				  </tr>
				  <tr>
				    <td>tests</td>
				    <td>card_identificator_tests.py</td>
					<td>Testes automatizados do identificador de cartas usando fotos de alta qualidade recortadas manualmente</td>
				  </tr>
				  <tr>
				    <td>tests</td>
				    <td>full_tests.py</td>
					<td>Testes automatizados do sistema de indentificação completo da aplicação usando fotos da webcam com diversas cartas e as coordenadas de cada carta</td>
				  </tr>
				  <tr>
				    <td>card_references</td>
				    <td>*.jpg</td>
					<td>Multiplos arquivos .jpg representando as imagens de referência. <br>OBS: Não estão no repositório do Github</td>
				  </tr>
				  <tr>
				    <td>tests/images/full_scene</td>
				    <td>*.png</td>
					<td>Imagens da mesa com múltiplas cartas uadas para os testes completos. <br>OBS: Não estão no repositório do Github</td>
				  </tr>
				  <tr>
				    <td>tests/images/sleeved</td>
				    <td>*.jpg</td>
					<td>Imagens de cartas recortadas com plástico para os testes do indentificador. <br>OBS: Não estão no repositório do Github</td>
				  </tr>
				  <tr>
				    <td>tests/images/unsleeved</td>
				    <td>*.jpg</td>
					<td>magens de cartas recortadas sem plástico para os testes do indentificador. <br>OBS: Não estão no repositório do Github</td>
				  </tr>
				</table> 

		<h3>2.7. Análise dos Resultados do Teste de Campo TCS</h3>

		<p>Com relação ao Teste de Campo, os usuários foram convidados a testar o programa desenvolvido pelo grupo. Para isso, deixamos a estrutura de apoio da webcam montada e as 
			instruções com o passo a passo para que o usuário, mesmo que leigo, conseguisse abrir o programa e testá-lo. O usuário utilizava o programa até que estivesse satisfeito com
			os testes.</p>

		<p>Após a etapa de teste do programa, o usuário era convidado a responder dois questionários, um deles era o Questionário Avaliativo (AQA), que tinha como objetivo, avaliar o 
			usuário, verificando se o mesmo tinha entendido a proposta do programa e suas funcionalidades. O outro questionário tinha como objetivo o forncecimento de feedback dos 
			usuários com relação ao programa, perguntando como foi a experiência do usuário e que tipo de alterações eram interessantes para a melhora do programa.</p>

		<a href="https://crakehallboars.github.io/project/parte4/SPV_application_quiz.html"> Instruções e Questionários</a> <br>

		<p>No Questionário Avaliativo, utilizamos critérios de avaliação que abrangem aspectos como usabilidade, funcionalidade e impacto na jogabilidade. Abaixo, explicamos detalhadamente 
			os critérios utilizados nesta avaliação:</p>

		<p>1. Objetivo Principal: Avalia se o usuário entende claramente qual é o objetivo fundamental do programa de reconhecimento de cartas no contexto do jogo Magic: The Gathering. Isso 
			abrange sua compreensão sobre como o programa melhora a jogabilidade e a interação entre os jogadores.</p>
		<p>2. Benefícios do Reconhecimento Automático: Verifica se o usuário compreende os benefícios práticos de usar o programa para identificar automaticamente as cartas no tabuleiro, em 
			comparação com a identificação manual. Isso envolve sua percepção sobre como o programa pode agilizar e enriquecer sua experiência de jogo.</p>
		<p>3. Contribuição para a Imersão: Avalia se o usuário entende como o programa de reconhecimento de cartas contribui para uma experiência mais imersiva, semelhante à versão física do 
			jogo. Isso inclui sua compreensão sobre como o programa simula a disposição das cartas e ações durante a partida.</p>
		<p>4. Evitando Trapaças e Erros: Verifica se o usuário reconhece a importância do programa na garantia da integridade do jogo e na prevenção de trapaças. Isso abrange sua percepção sobre 
			como o programa cria uma representação visual confiável das ações dos jogadores.</p>
		<p>5. Simplicidade de Uso: Avalia se o usuário entende a facilidade de uso do programa e como ele simplifica o processo de identificação de cartas, eliminando a necessidade de comunicação 
			verbal detalhada entre os jogadores.</p>
		<p>6. Compatibilidade com a Experiência Física: Verifica se o usuário compreende como o programa busca replicar a experiência física do jogo, permitindo que você utilize seu baralho real 
			durante as partidas online.</p>
		<p>7. Conhecimento técnico de Processamento de Vídeo: Avalia se o usuário entende a parte téorica por trás do funcionamento do programa.</p>

		<p>Ao avaliar cada um desses critérios, pretendemos entender o quão bem o usuário captou a proposta e os benefícios do programa de reconhecimento de cartas em Magic: The Gathering. 
			A sua visão é fundamental para o aprimoramento contínuo do programa e sua contribuição é altamente valorizada.</p>

		<p>Resultados do AQA:</p>

    		<img src='2.7/AQA/info.png'/>
		<img src='2.7/AQA/perguntas_erradas_freq.png'/>
		<img src='2.7/AQA/1.png'/>
		<img src='2.7/AQA/2.png'/>
		<img src='2.7/AQA/3.png'/>
		<img src='2.7/AQA/4.png'/>
		<img src='2.7/AQA/5.png'/>
		<img src='2.7/AQA/6.png'/>
		<img src='2.7/AQA/7.png'/>
		<img src='2.7/AQA/8.png'/>
		<img src='2.7/AQA/9.png'/>

		<p>Já no Questionário de Feedback, buscamos entender como foi a experiência do usuário utilizando nosso
		programa e quais melhorias poderiam ser implementadas.</p>

		<p>Resultados do Questionário de Feedback:</p>

		<img src='2.7/QFeedback/1.png'/>
		<img src='2.7/QFeedback/2.png'/>
		<img src='2.7/QFeedback/3.png'/>
		<img src='2.7/QFeedback/4.png'/>
		<img src='2.7/QFeedback/5.png'/>
		<img src='2.7/QFeedback/6.png'/>
		<img src='2.7/QFeedback/7.png'/>
		<img src='2.7/QFeedback/8.png'/>
		<img src='2.7/QFeedback/9.png'/>
				 
		<h2>3. Conclusão</h2>

		<p>Em conclusão, o sistema de reconhecimento de cartas para o jogo Magic: The Gathering é uma ferramenta útil e 
			eficaz para melhorar a jogabilidade e a interação entre os jogadores. Os resultados dos questionários 
			mostraram que os usuários entenderam claramente o objetivo do programa e tiveram uma experiência 
			positiva com o uso do mesmo. Algumas melhorias sugeridas pelos usuários poderiam ser implementadas para 
			tornar o programa ainda mais eficiente e fácil de usar.</p>

		<p>Com base nos resultados obtidos, podemos afirmar que os objetivos propostos na introdução foram atingidos. 
			O programa de reconhecimento de cartas para o jogo Magic: The Gathering foi desenvolvido com o objetivo 
			de melhorar a jogabilidade e a interação entre os jogadores, e os resultados dos questionários mostraram 
			que a maioria dos usuários teve uma experiência positiva com o uso do programa.</p>

		<p>No entanto, é importante destacar que alguns pontos negativos foram identificados durante a implementação do 
			programa. Por exemplo, alguns usuários relataram dificuldades em utilizar o programa em ambientes com 
			pouca iluminação ou com reflexos na mesa de jogo. Além disso, alguns usuários sugeriram melhorias na 
			questão da rotação da carta, ou seja, fazer com que o programa rotacione a carta para a orientação 
			"correta", independente de como a carta estiver.</p>

		<p>Por outro lado, os pontos positivos da implementação do programa também devem ser destacados. O programa foi 
			capaz de reconhecer parte das cartas utilizadas pelos usuários durante os testes de campo, o que 
			pode melhorar a jogabilidade e a interação entre os jogadores. Além disso, o programa tem o potencial de
			permitir que os jogadores utilizem seus baralhos físicos durante as partidas online, replicando a 
			experiência física do jogo.</p>

		<h2>4. Referências Bibliográficas</h2>

		<a href="https://nessy.info/post/2018-01-12-magic-the-gathering-card-recognition/"> https://nessy.info/post/2018-01-12-magic-the-gathering-card-recognition/</a> <br>

		<a href="https://github.com/dilanHewawitharana/Document-Scanner-using-OpenCV"> https://github.com/dilanHewawitharana/Document-Scanner-using-OpenCV</a> <br>

		<h2>5. Anexo</h2>
		
	</body>
</html>
